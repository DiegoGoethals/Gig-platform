<li id="@Job.Id" @onclick="SeeJobDetails">
	<h3>@Job.Name</h3>
	<p>Salary: @Job.Salary</p>
	<p>City: @Job.City</p>
	<p>Distance: @distance Km</p>
	<p>@Applications.Count() Applications</p>
	@foreach (var skill in Job.Skills)
	{
		<p>@skill.Name</p>
	}
</li>

@code {
	[Parameter]
	public JobResponseDto Job { get; set; }
	[Parameter]
	public NavigationManager NavigationManager { get; set; }
	[Parameter]
	public ILocationService LocationService { get; set; }
	[Parameter]
	public IApplicationService ApplicationService { get; set; }

	private IEnumerable<ApplicationResponseDto> Applications { get; set; } = Enumerable.Empty<ApplicationResponseDto>();

	private int distance { get; set; }

	protected override async Task OnInitializedAsync()
	{
		var userLocation = LocationService.GetUserLocation();
		distance = LocationService.GetDistance(Job.Latitude, Job.Longitude);
		Applications = await ApplicationService.GetAllByJobAsync(Job.Id);
	}

	private void SeeJobDetails() {
		NavigationManager.NavigateTo($"/job/{Job.Id}");
	}
}
